"use strict";const B=require("../shared/ssr-window.esm.js"),c=require("../shared/utils.js");function N(P){let{swiper:e,extendParams:S,on:I,emit:T}=P;const Y=B.a();S({mousewheel:{enabled:!1,releaseOnEdges:!1,invert:!1,forceToAxis:!1,sensitivity:1,eventsTarget:"container",thresholdDelta:null,thresholdTime:null,noMousewheelClass:"swiper-no-mousewheel"}}),e.mousewheel={enabled:!1};let E,g=c.d(),u;const i=[];function L(t){let o=0,r=0,s=0,l=0;return"detail"in t&&(r=t.detail),"wheelDelta"in t&&(r=-t.wheelDelta/120),"wheelDeltaY"in t&&(r=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(o=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(o=r,r=0),s=o*10,l=r*10,"deltaY"in t&&(l=t.deltaY),"deltaX"in t&&(s=t.deltaX),t.shiftKey&&!s&&(s=l,l=0),(s||l)&&t.deltaMode&&(t.deltaMode===1?(s*=40,l*=40):(s*=800,l*=800)),s&&!o&&(o=s<1?-1:1),l&&!r&&(r=l<1?-1:1),{spinX:o,spinY:r,pixelX:s,pixelY:l}}function _(){e.enabled&&(e.mouseEntered=!0)}function G(){e.enabled&&(e.mouseEntered=!1)}function y(t){return e.params.mousewheel.thresholdDelta&&t.delta<e.params.mousewheel.thresholdDelta||e.params.mousewheel.thresholdTime&&c.d()-g<e.params.mousewheel.thresholdTime?!1:t.delta>=6&&c.d()-g<60?!0:(t.direction<0?(!e.isEnd||e.params.loop)&&!e.animating&&(e.slideNext(),T("scroll",t.raw)):(!e.isBeginning||e.params.loop)&&!e.animating&&(e.slidePrev(),T("scroll",t.raw)),g=new Y.Date().getTime(),!1)}function O(t){const a=e.params.mousewheel;if(t.direction<0){if(e.isEnd&&!e.params.loop&&a.releaseOnEdges)return!0}else if(e.isBeginning&&!e.params.loop&&a.releaseOnEdges)return!0;return!1}function w(t){let a=t,b=!0;if(!e.enabled||t.target.closest(`.${e.params.mousewheel.noMousewheelClass}`))return;const f=e.params.mousewheel;e.params.cssMode&&a.preventDefault();let o=e.el;e.params.mousewheel.eventsTarget!=="container"&&(o=document.querySelector(e.params.mousewheel.eventsTarget));const r=o&&o.contains(a.target);if(!e.mouseEntered&&!r&&!f.releaseOnEdges)return!0;a.originalEvent&&(a=a.originalEvent);let s=0;const l=e.rtlTranslate?-1:1,d=L(a);if(f.forceToAxis)if(e.isHorizontal())if(Math.abs(d.pixelX)>Math.abs(d.pixelY))s=-d.pixelX*l;else return!0;else if(Math.abs(d.pixelY)>Math.abs(d.pixelX))s=-d.pixelY;else return!0;else s=Math.abs(d.pixelX)>Math.abs(d.pixelY)?-d.pixelX*l:-d.pixelY;if(s===0)return!0;f.invert&&(s=-s);let h=e.getTranslate()+s*f.sensitivity;if(h>=e.minTranslate()&&(h=e.minTranslate()),h<=e.maxTranslate()&&(h=e.maxTranslate()),b=e.params.loop?!0:!(h===e.minTranslate()||h===e.maxTranslate()),b&&e.params.nested&&a.stopPropagation(),!e.params.freeMode||!e.params.freeMode.enabled){const n={time:c.d(),delta:Math.abs(s),direction:Math.sign(s),raw:t};i.length>=2&&i.shift();const m=i.length?i[i.length-1]:void 0;if(i.push(n),m?(n.direction!==m.direction||n.delta>m.delta||n.time>m.time+150)&&y(n):y(n),O(n))return!0}else{const n={time:c.d(),delta:Math.abs(s),direction:Math.sign(s)},m=u&&n.time<u.time+500&&n.delta<=u.delta&&n.direction===u.direction;if(!m){u=void 0;let p=e.getTranslate()+s*f.sensitivity;const A=e.isBeginning,C=e.isEnd;if(p>=e.minTranslate()&&(p=e.minTranslate()),p<=e.maxTranslate()&&(p=e.maxTranslate()),e.setTransition(0),e.setTranslate(p),e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses(),(!A&&e.isBeginning||!C&&e.isEnd)&&e.updateSlidesClasses(),e.params.loop&&e.loopFix({direction:n.direction<0?"next":"prev",byMousewheel:!0}),e.params.freeMode.sticky){clearTimeout(E),E=void 0,i.length>=15&&i.shift();const M=i.length?i[i.length-1]:void 0,H=i[0];if(i.push(n),M&&(n.delta>M.delta||n.direction!==M.direction))i.splice(0);else if(i.length>=15&&n.time-H.time<500&&H.delta-n.delta>=1&&n.delta<=6){const X=s>0?.8:.2;u=n,i.splice(0),E=c.n(()=>{e.destroyed||!e.params||e.slideToClosest(e.params.speed,!0,void 0,X)},0)}E||(E=c.n(()=>{if(e.destroyed||!e.params)return;const X=.5;u=n,i.splice(0),e.slideToClosest(e.params.speed,!0,void 0,X)},500))}if(m||T("scroll",a),e.params.autoplay&&e.params.autoplayDisableOnInteraction&&e.autoplay.stop(),f.releaseOnEdges&&(p===e.minTranslate()||p===e.maxTranslate()))return!0}}return a.preventDefault?a.preventDefault():a.returnValue=!1,!1}function D(t){let a=e.el;e.params.mousewheel.eventsTarget!=="container"&&(a=document.querySelector(e.params.mousewheel.eventsTarget)),a[t]("mouseenter",_),a[t]("mouseleave",G),a[t]("wheel",w)}function v(){return e.params.cssMode?(e.wrapperEl.removeEventListener("wheel",w),!0):e.mousewheel.enabled?!1:(D("addEventListener"),e.mousewheel.enabled=!0,!0)}function x(){return e.params.cssMode?(e.wrapperEl.addEventListener(event,w),!0):e.mousewheel.enabled?(D("removeEventListener"),e.mousewheel.enabled=!1,!0):!1}I("init",()=>{!e.params.mousewheel.enabled&&e.params.cssMode&&x(),e.params.mousewheel.enabled&&v()}),I("destroy",()=>{e.params.cssMode&&v(),e.mousewheel.enabled&&x()}),Object.assign(e.mousewheel,{enable:v,disable:x})}module.exports=N;
